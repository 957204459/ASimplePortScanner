# ASimplePortScanner
单文件无依赖Python端口扫描脚本，支持一些简单漏洞的探测

默认 TCP UDP 都跑

默认端口：21-23,25,80,81,110,135,137,139,445,873,1433,1521,3306,3389,6379,7001,8000,8069,8080-8090,9000,9001,10051,11211

UDP 的可以自己加

缺点，一个 ip 开一个线程，所以没法 Keyboardinterrupt 结束，有空改成用队列

## 功能:
- 多线程端口，获取 banner 信息
- 提取 HTTP HTTPS 协议中的有效信息，返回头中 Server、Location， 返回体中 <title>
- 通过 NBNS 协议获取主机名 (UDP 137)
- Redis 检测未授权
- MS17-010 检测 (抄了巡风的脚本)
- 通过 445 检测 Windows 的版本 (抄了 17-010 的 PHP 脚本)

## 用法:
```
python scan.py ip [UT] [ports]
```
ip 可以是 单个ip、CIDR 或者 192.168.0.0-255 这种形式
U 就是 UDP 端口探测，现在只有 137 端口 
T 就是探测 TCP 端口
ports 指定 TCP 的端口

## 例子:
```
python scan.py 10.19.38.0/24
```
扫描 10.19.38.0/24 的默认端口，并获取主机名

```
python scan.py 10.19.38.0/24 U
```
获取 10.19.38.0/24 的主机名，不扫描 TCP 端口

```
python scan.py 10.19.38.0/24 TU 22,23-25
```
扫描 10.19.38.0/24 的 TCP 22,23,24,25 端口，获取主机名
